<%- include('partials/header', { title: 'Become a Member' }) %>

<div class="max-w-4xl mx-auto px-4 py-12">
  <div class="flex justify-center">
    <div class="w-full max-w-md">
      <div class="bg-white shadow-lg rounded-lg overflow-hidden">
        <div class="p-6 md:p-8">
          <div class="text-center mb-6">
            <h2 class="text-2xl font-bold text-gray-800">Become a Full Member</h2>
            <p class="text-gray-500">Unlock full access by entering the secret passcode.</p>
          </div>

          <% if (locals.error && locals.error.length > 0) { %>
          <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative mb-4" role="alert">
            <span class="block sm:inline">
              <%= Array.isArray(error) ? error.join(', ') : error %>
            </span>
          </div>
          <% } %>

          <% if (user.is_member) { %>
          <div class="bg-green-100 border border-green-400 text-green-700 px-6 py-5 rounded text-center mb-4" role="alert">
            <h4 class="text-xl font-semibold mb-2 flex items-center justify-center gap-2">
              <i class="fas fa-check-circle"></i>
              You Are Already a Member!
            </h4>
            <p>You have full access to all community features.</p>
            <div class="my-4">
              <a href="/messages" class="inline-flex items-center gap-2 bg-blue-600 text-white px-5 py-2 rounded hover:bg-blue-700 transition">
                <i class="fas fa-tachometer-alt"></i>
                Go to Dashboard
              </a>
            </div>
          </div>
          <% } else { %>

          <form action="/become-member" method="post" class="space-y-5">
            <div>
              <label for="secret_code" class="block text-sm font-medium text-gray-700 mb-1">Secret Passcode</label>
              <input
                type="password"
                id="secret_code"
                name="secret_code"
                placeholder="Secret Passcode"
                required
                class="w-full px-4 py-3 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
              />
            </div>

            <button
              type="submit"
              class="w-full flex items-center justify-center gap-2 bg-blue-600 text-white py-3 rounded-md text-lg hover:bg-blue-700 transition"
            >
              <i class="fas fa-lock-open"></i> Unlock Membership
            </button>
          </form>

          <hr class="my-6" />

          <div class="text-center">
            <p class="text-gray-600 mb-2">Don't have the code?</p>
            <a href="/get-the-code" class="inline-block border border-gray-400 px-4 py-2 rounded hover:bg-gray-100 transition">
              Solve the Riddle to Get It
            </a>
          </div>

          <% } %>
        </div>
      </div>
    </div>
  </div>
</div>

<%- include('partials/footer') %>
